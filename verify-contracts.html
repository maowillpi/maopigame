<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆçº¦éªŒè¯</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body style="padding: 20px; font-family: Arial, sans-serif;">
    <h1>ğŸ” AlveyChain åˆçº¦éªŒè¯</h1>
    
    <button onclick="verifyContracts()" style="padding: 10px 20px; font-size: 16px; margin: 10px;">
        éªŒè¯åˆçº¦åœ°å€
    </button>
    
    <div id="result" style="margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 5px;"></div>

    <script>
        // åˆçº¦åœ°å€
        const CONTRACTS = {
            MAO_TOKEN: "0x22f49bcb3dad370a9268ba3fca33cb037ca3d022",
            PI_TOKEN: "0xfd4680e25e05b3435c7f698668d1ce80d2a9f444",
            WHEEL_GAME: "0xc27e29BCe41db77815435a9415329424849Daeb6"
        };

        // AlveyChain ç½‘ç»œé…ç½®
        const ALVEY_NETWORK = {
            chainId: '0xED5', // 3797
            chainName: 'AlveyChain Mainnet',
            rpcUrls: [
                'https://elves-core1.alvey.io/',
                'https://elves-core2.alvey.io/',
                'https://elves-core3.alvey.io/'
            ]
        };

        async function verifyContracts() {
            const resultDiv = document.getElementById('result');
            
            try {
                resultDiv.innerHTML = 'ğŸ”„ éªŒè¯ä¸­...';
                
                // 1. æ£€æŸ¥ç½‘ç»œ
                if (window.ethereum) {
                    const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                    resultDiv.innerHTML += `<br>å½“å‰ç½‘ç»œ: ${chainId} (éœ€è¦: ${ALVEY_NETWORK.chainId})`;
                    
                    if (chainId !== ALVEY_NETWORK.chainId) {
                        resultDiv.innerHTML += `<br>âŒ ç½‘ç»œä¸åŒ¹é…ï¼è¯·åˆ‡æ¢åˆ°AlveyChain`;
                        return;
                    }
                }
                
                // 2. åˆ›å»ºprovider
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                
                // 3. éªŒè¯æ¯ä¸ªåˆçº¦
                let report = '<h3>ğŸ“‹ åˆçº¦éªŒè¯æŠ¥å‘Š</h3>';
                
                for (const [name, address] of Object.entries(CONTRACTS)) {
                    try {
                        const code = await provider.getCode(address);
                        const hasCode = code !== '0x';
                        const status = hasCode ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨';
                        
                        report += `<p><strong>${name}:</strong> ${address}<br>çŠ¶æ€: ${status}</p>`;
                        
                        if (hasCode) {
                            // å¦‚æœæ˜¯ä»£å¸åˆçº¦ï¼Œå°è¯•è°ƒç”¨ä¸€äº›åŸºæœ¬å‡½æ•°
                            if (name.includes('TOKEN')) {
                                const erc20ABI = [
                                    "function name() view returns (string)",
                                    "function symbol() view returns (string)",
                                    "function decimals() view returns (uint8)",
                                    "function totalSupply() view returns (uint256)"
                                ];
                                
                                try {
                                    const contract = new ethers.Contract(address, erc20ABI, provider);
                                    const [tokenName, symbol, decimals] = await Promise.all([
                                        contract.name(),
                                        contract.symbol(), 
                                        contract.decimals()
                                    ]);
                                    
                                    report += `&nbsp;&nbsp;â€¢ åç§°: ${tokenName}<br>`;
                                    report += `&nbsp;&nbsp;â€¢ ç¬¦å·: ${symbol}<br>`;
                                    report += `&nbsp;&nbsp;â€¢ ç²¾åº¦: ${decimals} ä½å°æ•°<br>`;
                                } catch (funcError) {
                                    report += `&nbsp;&nbsp;â€¢ âš ï¸ ERC20å‡½æ•°è°ƒç”¨å¤±è´¥: ${funcError.message}<br>`;
                                }
                            }
                            
                            // å¦‚æœæ˜¯æ¸¸æˆåˆçº¦ï¼Œæ£€æŸ¥æ¸¸æˆå‚æ•°
                            if (name.includes('WHEEL_GAME')) {
                                const gameABI = [
                                    "function MAO_BET_AMOUNT() view returns (uint256)",
                                    "function PI_BET_AMOUNT() view returns (uint256)",
                                    "function maoRewards(uint256) view returns (uint256)",
                                    "function piRewards(uint256) view returns (uint256)"
                                ];
                                
                                try {
                                    const contract = new ethers.Contract(address, gameABI, provider);
                                    const [maoBet, piBet, maoReward1, piReward1] = await Promise.all([
                                        contract.MAO_BET_AMOUNT(),
                                        contract.PI_BET_AMOUNT(),
                                        contract.maoRewards(1),
                                        contract.piRewards(1)
                                    ]);
                                    
                                    report += `&nbsp;&nbsp;â€¢ MAOæŠ•æ³¨é‡‘é¢: ${maoBet.toString()} wei<br>`;
                                    report += `&nbsp;&nbsp;â€¢ PIæŠ•æ³¨é‡‘é¢: ${piBet.toString()} wei<br>`;
                                    report += `&nbsp;&nbsp;â€¢ MAOå°å¥–å¥–åŠ±: ${maoReward1.toString()} wei<br>`;
                                    report += `&nbsp;&nbsp;â€¢ PIå°å¥–å¥–åŠ±: ${piReward1.toString()} wei<br>`;
                                    
                                    // æ¢ç®—æˆäººç±»å¯è¯»çš„æ•°å­—ï¼ˆå‡è®¾æ˜¯9ä½å°æ•°ï¼‰
                                    const maoBetReadable = ethers.utils.formatUnits(maoBet, 9);
                                    const piBetReadable = ethers.utils.formatUnits(piBet, 9);
                                    const maoRewardReadable = ethers.utils.formatUnits(maoReward1, 9);
                                    const piRewardReadable = ethers.utils.formatUnits(piReward1, 9);
                                    
                                    report += `&nbsp;&nbsp;ğŸ“Š æŒ‰9ä½å°æ•°è®¡ç®—:<br>`;
                                    report += `&nbsp;&nbsp;&nbsp;&nbsp;â€¢ MAOæŠ•æ³¨: ${maoBetReadable} MAO<br>`;
                                    report += `&nbsp;&nbsp;&nbsp;&nbsp;â€¢ PIæŠ•æ³¨: ${piBetReadable} PI<br>`;
                                    report += `&nbsp;&nbsp;&nbsp;&nbsp;â€¢ MAOå°å¥–: ${maoRewardReadable} MAO<br>`;
                                    report += `&nbsp;&nbsp;&nbsp;&nbsp;â€¢ PIå°å¥–: ${piRewardReadable} PI<br>`;
                                    
                                } catch (funcError) {
                                    report += `&nbsp;&nbsp;â€¢ âš ï¸ æ¸¸æˆå‚æ•°è°ƒç”¨å¤±è´¥: ${funcError.message}<br>`;
                                }
                            }
                        }
                    } catch (error) {
                        report += `<p><strong>${name}:</strong> ${address}<br>âŒ éªŒè¯å¤±è´¥: ${error.message}</p>`;
                    }
                }
                
                // 4. æµ‹è¯•ç½‘ç»œè¿æ¥
                try {
                    const blockNumber = await provider.getBlockNumber();
                    report += `<p><strong>ç½‘ç»œçŠ¶æ€:</strong> âœ… æ­£å¸¸<br>å½“å‰åŒºå—: ${blockNumber}</p>`;
                } catch (error) {
                    report += `<p><strong>ç½‘ç»œçŠ¶æ€:</strong> âŒ è¿æ¥å¤±è´¥: ${error.message}</p>`;
                }
                
                resultDiv.innerHTML = report;
                
            } catch (error) {
                console.error('éªŒè¯å¤±è´¥:', error);
                resultDiv.innerHTML = `âŒ éªŒè¯å¤±è´¥: ${error.message}`;
            }
        }
    </script>
</body>
</html> 